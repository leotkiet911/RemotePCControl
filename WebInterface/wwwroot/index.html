<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remote PC Control - HCMUS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.1/signalr.min.js"></script>

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🖥️ Remote PC Control v2.0</h1>
            <p>HCMUS - Socket Programming Project | Real-time Webcam Streaming</p>
        </div>

        <div class="content">
            <div id="modeSelection" class="mode-selection">
                    <div class="mode-card" onclick="selectMode('controlled')">
                        <div class="icon">💻</div>
                        <h3>PC bị điều khiển</h3>
                        <p>Tự tải & chạy ClientControlled</p>
                    </div>
                    <div class="mode-card" onclick="selectMode('controller')">
                        <div class="icon">🎮</div>
                        <h3>Người điều khiển</h3>
                        <p>Điều khiển một máy tính từ xa</p>
                    </div>
            </div>

                <div id="controlledSection" class="form-section">
                    <h3 style="margin-bottom: 16px;">💻 Cài đặt máy bị điều khiển</h3>
                    <div id="serverInfoCard" class="info-card">
                        <div>
                            <p class="muted">Server</p>
                            <h4 id="serverEndpoint">Đang tải thông tin server...</h4>
                        </div>
                        <button class="btn-download" onclick="downloadClientPackage()">⬇️ Tải gói ClientControlled</button>
                    </div>
                    <div class="info-card">
                        <ol class="steps">
                            <li>Tải file <b>client-controlled.zip</b> và giải nén.</li>
                            <li>Chạy <code>ClientControlled.exe</code> trong thư mục giải nén.</li>
                            <li>Sau khi chạy, IP &amp; Password sẽ hiển thị tại đây và trên cửa sổ app.</li>
                        </ol>
                    </div>
                    <div class="info-card">
                        <div class="card-header">
                            <div>
                                <p class="muted">Trạng thái</p>
                                <h4>Danh sách máy đã đăng ký</h4>
                            </div>
                            <button class="btn-primary small" onclick="refreshSessions()">🔄 Làm mới</button>
                        </div>
                        <div id="sessionList" class="session-list">Chưa có máy kết nối.</div>
                    </div>
                    <button class="btn-secondary" style="margin-top: 12px;" onclick="selectMode(null)">← Quay lại</button>
                </div>

            <div id="loginSection" class="form-section">
                <h3 style="margin-bottom: 20px;">🔐 Đăng nhập để điều khiển</h3>
                <div id="loginError" class="error-message"></div>
                <div class="input-group">
                    <label>Tài khoản (IP Address)</label>
                    <input type="text" id="loginIp" placeholder="192.168.1.100" value="127.0.0.1">
                </div>
                <div class="input-group">
                    <label>Mật khẩu</label>
                    <input type="password" id="loginPassword" placeholder="Nhập mật khẩu 6 số">
                </div>
                <button class="btn btn-primary" onclick="login()">Kết nối</button>
                <button class="btn btn-secondary" onclick="selectMode(null)">← Quay lại</button>
            </div>
           

            <div id="controlPanel" class="control-panel">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h3 style="display: flex; align-items: center;">
                        <span class="status-indicator status-connected"></span>
                        <span id="connectedIp"></span>
                    </h3>
                    <button class="btn-secondary" style="padding: 8px 16px; border-radius: 6px; border: none; cursor: pointer;" onclick="disconnect()">Ngắt kết nối</button>
                </div>

                <div class="tabs">
                    <button class="tab active" onclick="switchTab('apps')">📱 Apps</button>
                    <button class="tab" onclick="switchTab('processes')">⚙️ Processes</button>
                    <button class="tab" onclick="switchTab('screen')">📸 Screenshot</button>
                    <button class="tab" onclick="switchTab('keylog')">⌨️ Keylogger</button>
                    <button class="tab" onclick="switchTab('webcam')">📹 Webcam</button>
                    <button class="tab" onclick="switchTab('system')">🔋 System</button>
                </div>

                <div id="appsTab" class="tab-content active">
                    <div class="action-buttons">
                        <div class="action-btn" onclick="listApplications()">
                            <div class="icon">📋</div>
                            <h4>Danh sách Apps</h4>
                            <p>Xem ứng dụng đang chạy</p>
                        </div>
                        <div class="action-btn" onclick="startApp()">
                            <div class="icon">▶️</div>
                            <h4>Mở ứng dụng</h4>
                            <p>Khởi chạy app mới</p>
                        </div>
                    </div>
                    <div id="appsList" class="list-container"></div>
                </div>

                <div id="processesTab" class="tab-content">
                    <div class="action-buttons">
                        <div class="action-btn" onclick="listProcesses()">
                            <div class="icon">📋</div>
                            <h4>Danh sách Processes</h4>
                            <p>Xem tiến trình đang chạy</p>
                        </div>
                        <div class="action-btn" onclick="startProcess()">
                            <div class="icon">▶️</div>
                            <h4>Chạy Process</h4>
                            <p>Khởi động tiến trình</p>
                        </div>
                    </div>
                    <div id="processesList" class="list-container"></div>
                </div>

                <div id="screenTab" class="tab-content">
                    <div class="action-buttons">
                        <div class="action-btn" onclick="takeScreenshot()">
                            <div class="icon">📸</div>
                            <h4>Chụp màn hình</h4>
                            <p>Lấy ảnh màn hình</p>
                        </div>
                    </div>
                    <div id="screenshotContainer"></div>
                </div>

                <div id="keylogTab" class="tab-content">
                    <div class="action-buttons">
                        <div class="action-btn" onclick="getKeylogs()">
                            <div class="icon">📥</div>
                            <h4>Lấy Keylogs</h4>
                            <p>Xem phím đã bấm</p>
                        </div>
                        <div class="action-btn" onclick="clearKeylogs()">
                            <div class="icon">🗑️</div>
                            <h4>Xóa Keylogs</h4>
                            <p>Xóa lịch sử</p>
                        </div>
                    </div>
                    <div class="keylog-display" id="keylogDisplay">Nhấn "Lấy Keylogs" để xem...</div>
                </div>

                <div id="webcamTab" class="tab-content">
                    <div class="action-buttons">
                        <div class="action-btn" onclick="startWebcam()">
                            <div class="icon">📹</div>
                            <h4>Bật Webcam</h4>
                            <p>Khởi động camera</p>
                        </div>
                        <div class="action-btn" onclick="startWebcamStream()">
                            <div class="icon">🔴</div>
                            <h4>Live Stream</h4>
                            <p>Xem trực tiếp</p>
                        </div>
                        <div class="action-btn" onclick="stopWebcamStream()">
                            <div class="icon">⏸️</div>
                            <h4>Dừng Stream</h4>
                            <p>Tạm dừng video</p>
                        </div>
                        <div class="action-btn" onclick="captureWebcam()">
                            <div class="icon">📸</div>
                            <h4>Chụp ảnh</h4>
                            <p>Snapshot từ webcam</p>
                        </div>
                        <div class="action-btn" onclick="stopWebcam()">
                            <div class="icon">⏹️</div>
                            <h4>Tắt Webcam</h4>
                            <p>Đóng camera</p>
                        </div>
                    </div>

                    <div class="webcam-container" id="webcamContainer">
                        <div class="webcam-placeholder">
                            <div class="icon">📹</div>
                            <h3>Webcam chưa khởi động</h3>
                            <p>Nhấn "Bật Webcam" và "Live Stream" để bắt đầu</p>
                        </div>
                    </div>

                    <div id="webcamSnapshots" class="webcam-snapshots"></div>
                </div>

                <div id="systemTab" class="tab-content">
                    <div class="action-buttons">
                        <div class="action-btn" onclick="shutdownPC()">
                            <div class="icon">🔴</div>
                            <h4>Shutdown</h4>
                            <p>Tắt máy tính</p>
                        </div>
                        <div class="action-btn" onclick="restartPC()">
                            <div class="icon">🔄</div>
                            <h4>Restart</h4>
                            <p>Khởi động lại</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>